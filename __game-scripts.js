class Config{constructor(){this.fullscreen=!0,this.music_volume=1,this.fx_volume=1,this.mouse=.5,this.gamepad=.5}zapis(){console.log("Zapisuję dane config"),localStorage.setItem("game_config_options",JSON.stringify(this))}volume_down(){return this.music_volume>.1&&(this.music_volume-=.1),this.music_volume}volume_up(){return this.music_volume<1&&(this.music_volume+=.1),this.music_volume}mouse_down(){return this.mouse>.2&&(this.mouse-=.1),this.mouse}mouse_up(){return this.mouse<.9&&(this.mouse+=.1),this.mouse}gamepad_down(){return this.gamepad>.2&&(this.gamepad-=.1),this.gamepad}gamepad_up(){return this.gamepad<.9&&(this.gamepad+=.1),this.gamepad}static odczyt(){var s=localStorage.getItem("game_config_options");if(null==s)return console.log("Nie wczytano danych config"),(e=new Config).zapis(),e;console.log("Wczytano config");var e=new Config;return Object.assign(e,JSON.parse(s)),e}}var FirstPersonMovement=pc.createScript("firstPersonMovement");FirstPersonMovement.attributes.add("camera",{type:"entity"}),FirstPersonMovement.attributes.add("movementSpeed",{type:"number",default:25}),FirstPersonMovement.attributes.add("runSpeed",{type:"number",default:50}),FirstPersonMovement.attributes.add("interactionReach",{type:"number",default:4}),FirstPersonMovement.attributes.add("jumpForce",{type:"number",default:500}),FirstPersonMovement.attributes.add("mouseSensitivity",{type:"number",default:.25}),FirstPersonMovement.attributes.add("crosshair",{type:"entity"}),FirstPersonMovement.prototype.initialize=function(){this.force=new pc.Vec3,this.eulers=new pc.Vec3,this.app.mouse.on("mousemove",this._onMouseMove,this),this.is_holding_smh=!1,this.on("destroy",(function(){this.app.mouse.off("mousemove",this._onMouseMove,this)})),this.on("state",(function(e){e?this.app.mouse.on("mousemove",this._onMouseMove,this):this.app.mouse.off("mousemove",this._onMouseMove,this)}))},FirstPersonMovement.prototype.update=function(e){this.handle_movement(e),this.handle_jump(),this.handle_interaction()},FirstPersonMovement.prototype.let_go=function(){this.is_holding_smh=!1},FirstPersonMovement.prototype.handle_interaction=function(){if(!this.is_holding_smh){var e=this.camera.getPosition(),t=this.camera.forward.normalize(),s=(e=e.clone().add(t.scale(.55))).clone().add(t.scale(this.interactionReach-.55)),i=this.app.systems.rigidbody.raycastFirst(e,s);if(i&&i.entity.script){var o=i.entity.script.holdingBox;null!=o?(this.crosshair.element.color.equals(pc.Color.GREEN)||(this.crosshair.element.color=pc.Color.GREEN),this.app.keyboard.wasPressed(pc.KEY_E)&&(this.is_holding_smh=!0,o.use(this.camera),this.crosshair.element.color=pc.Color.WHITE)):this.crosshair.element.color.equals(pc.Color.WHITE)||(this.crosshair.element.color=pc.Color.WHITE)}else this.crosshair.element.color.equals(pc.Color.WHITE)||(this.crosshair.element.color=pc.Color.WHITE)}},FirstPersonMovement.prototype._onMouseMove=function(e){(pc.Mouse.isPointerLocked()||e.buttons[0])&&(this.eulers.x-=this.mouseSensitivity*e.dx,this.eulers.y-this.mouseSensitivity*e.dy>-90&&this.eulers.y-this.mouseSensitivity*e.dy<90?this.eulers.y-=this.mouseSensitivity*e.dy:this.eulers.y-this.mouseSensitivity*e.dy<=-90?this.eulers.y=-90:this.eulers.y-this.mouseSensitivity*e.dy>=90&&(this.eulers.y=90),this.camera.setLocalEulerAngles(this.eulers.y,this.eulers.x,0))},FirstPersonMovement.prototype.handle_jump=function(){if(this.app.keyboard.wasPressed(pc.KEY_SPACE)){var e=this.entity.getPosition(),t=new pc.Vec3(e.x,e.y-1.1,e.z);this.app.systems.rigidbody.raycastFirst(e,t)&&this.entity.rigidbody.applyImpulse(new pc.Vec3(0,this.jumpForce,0))}},FirstPersonMovement.prototype.handle_movement=function(e){var t=this.movementSpeed;this.app.keyboard.isPressed(pc.KEY_SHIFT)&&(t=this.runSpeed);var s=new pc.Vec3(0,this.entity.rigidbody.linearVelocity.y,0);this.app.keyboard.isPressed(pc.KEY_A)&&((o=new pc.Vec3).copy(this.camera.right.normalize().scale(-1*t*e)).add(s),s=o.clone());this.app.keyboard.isPressed(pc.KEY_D)&&((o=new pc.Vec3).copy(this.camera.right.normalize().scale(t*e)).add(s),s=o.clone());if(this.app.keyboard.isPressed(pc.KEY_W)){var i=new pc.Vec3(0,0,-t*e);i=(new pc.Quat).setFromEulerAngles(0,this.eulers.x,0).transformVector(i),(o=new pc.Vec3).copy(i).add(s),s=o.clone()}if(this.app.keyboard.isPressed(pc.KEY_S)){var o;i=new pc.Vec3(0,0,t*e);i=(new pc.Quat).setFromEulerAngles(0,this.eulers.x,0).transformVector(i),(o=new pc.Vec3).copy(i).add(s),s=o.clone()}this.entity.rigidbody.linearVelocity=s.clone()};var LoadOptionsMenu=pc.createScript("loadOptionsMenu");LoadOptionsMenu.attributes.add("mainMenu",{type:"entity"}),LoadOptionsMenu.attributes.add("optionsMenu",{type:"entity"}),LoadOptionsMenu.prototype.initialize=function(){this.entity.button.on("click",(function(t){this.mainMenu.enabled=!1,this.optionsMenu.enabled=!0}),this)},LoadOptionsMenu.prototype.update=function(t){};var OptionsGoBackToMenu=pc.createScript("optionsGoBackToMenu");OptionsGoBackToMenu.attributes.add("mainMenu",{type:"entity"}),OptionsGoBackToMenu.attributes.add("optionsMenu",{type:"entity"}),OptionsGoBackToMenu.attributes.add("btnDownMusic",{type:"entity"}),OptionsGoBackToMenu.attributes.add("btnUpMusic",{type:"entity"}),OptionsGoBackToMenu.attributes.add("lblMusicText",{type:"entity"}),OptionsGoBackToMenu.attributes.add("btnDownMouse",{type:"entity"}),OptionsGoBackToMenu.attributes.add("btnUpMouse",{type:"entity"}),OptionsGoBackToMenu.attributes.add("lblMouseText",{type:"entity"}),OptionsGoBackToMenu.attributes.add("btnDownGamePad",{type:"entity"}),OptionsGoBackToMenu.attributes.add("btnUpGamePad",{type:"entity"}),OptionsGoBackToMenu.attributes.add("lblGamepadText",{type:"entity"}),OptionsGoBackToMenu.prototype.initialize=function(){this.loadConfigData(),this.on("state",this.onStateChanged,this),this.entity.button.on("click",(function(t){this.config.zapis(),this.mainMenu.enabled=!0,this.optionsMenu.enabled=!1}),this),this.btnDownMusic.button.on("click",(function(t){this.lblMusicText.element.text=this.config.volume_down().toFixed(1),this.app.root.findByName("musicentity").sound.volume=this.config.music_volume}),this),this.btnUpMusic.button.on("click",(function(t){this.lblMusicText.element.text=this.config.volume_up().toFixed(1),this.app.root.findByName("musicentity").sound.volume=this.config.music_volume}),this),this.btnDownMouse.button.on("click",(function(t){this.lblMouseText.element.text=this.config.mouse_down().toFixed(1)}),this),this.btnUpMouse.button.on("click",(function(t){this.lblMouseText.element.text=this.config.mouse_up().toFixed(1)}),this),this.btnDownGamePad.button.on("click",(function(t){this.lblGamepadText.element.text=this.config.gamepad_down().toFixed(1)}),this),this.btnUpGamePad.button.on("click",(function(t){this.lblGamepadText.element.text=this.config.gamepad_up().toFixed(1)}),this)},OptionsGoBackToMenu.prototype.onStateChanged=function(t){t&&this.loadConfigData(),this.config.zapis()},OptionsGoBackToMenu.prototype.loadConfigData=function(){this.config=Config.odczyt(),this.lblMusicText.element.text=this.config.music_volume.toFixed(1),this.lblMouseText.element.text=this.config.mouse.toFixed(1),this.lblGamepadText.element.text=this.config.gamepad.toFixed(1)};var BtnStartGame=pc.createScript("btnStartGame");BtnStartGame.attributes.add("mainMenu",{type:"entity"}),BtnStartGame.attributes.add("startGameMenu",{type:"entity"}),BtnStartGame.attributes.add("loadsGame",{type:"boolean"}),BtnStartGame.prototype.initialize=function(){this.entity.button.on("click",(function(t){for(var e=this.startGameMenu.children.filter((function(t){return"btnGoBack"!=t.name})),a=0;a<e.length;a++){var n=e[a],i=n.children[0];n.script.btnZapisClick.do_load=this.loadsGame,n.button.active=!0;var r=Gra.odczyt(a);null!=r?i.element.text="Zapis "+(a+1)+"\n"+r.scena:(i.element.text="Zapis "+(a+1)+"\nPusty",this.loadsGame&&(n.button.active=!1))}this.mainMenu.enabled=!1,this.startGameMenu.enabled=!0}),this)};class Gra{constructor(t){this.scena="Lvl1",this.id=t,this.trigger=0}zapis(){localStorage.setItem("game_zapis"+this.id,JSON.stringify(this))}static odczyt(t){var a=localStorage.getItem("game_zapis"+t);if(null==a)return null;var e=new Gra;return Object.assign(e,JSON.parse(a)),e}static czy_istnieje(t){return null!=localStorage.getItem("game_zapis"+t)}static aktywny(){var t=localStorage.getItem("active_zapis");return null!=t?Gra.odczyt(t):null}}var MainMenuRoot=pc.createScript("mainMenuRoot");MainMenuRoot.attributes.add("btnLoadGame",{type:"entity"}),MainMenuRoot.prototype.initialize=function(){Gra.czy_istnieje(0)||Gra.czy_istnieje(1)||Gra.czy_istnieje(2)?(console.log("Znaleziono jakiś zapis gry."),this.btnLoadGame.enabled=!0):(console.log("Nie znaleziono żadnego zapisu gry."),this.btnLoadGame.enabled=!1)},MainMenuRoot.prototype.update=function(e){};var GoBackToMenu=pc.createScript("goBackToMenu");GoBackToMenu.attributes.add("mainMenu",{type:"entity"}),GoBackToMenu.attributes.add("optionsMenu",{type:"entity"}),GoBackToMenu.prototype.initialize=function(){this.entity.button.on("click",(function(t){this.mainMenu.enabled=!0,this.optionsMenu.enabled=!1}),this)};var BtnZapisClick=pc.createScript("btnZapisClick");BtnZapisClick.attributes.add("do_load",{type:"boolean",default:!0}),BtnZapisClick.attributes.add("id_zapisu",{type:"number",default:0}),BtnZapisClick.prototype.initialize=function(){this.entity.button.on("click",(function(i){if(this.do_load){t=Gra.odczyt(this.id_zapisu);this.app.scenes.changeScene(t.scena)}else{var t;(t=new Gra(this.id_zapisu)).zapis(),this.app.scenes.changeScene(t.scena)}localStorage.setItem("active_zapis",this.id_zapisu)}),this)};var DefaultPos=pc.createScript("defaultPos");DefaultPos.prototype.initialize=function(){this.pos=this.entity.getPosition().clone()},DefaultPos.prototype.get=function(){return this.pos.clone()};var Pauza=pc.createScript("pauza");Pauza.attributes.add("menuPauzy",{type:"entity"}),Pauza.attributes.add("optionsMenuPauzy",{type:"entity"}),Pauza.attributes.add("player",{type:"entity"}),Pauza.attributes.add("player2",{type:"entity"}),Pauza.attributes.add("save_triggers",{type:"entity",array:!0}),Pauza.prototype.initialize=function(){this._g=new pc.GamePads,this.menuPauzy.enabled=!1,this.app.keyboard.on(pc.EVENT_KEYDOWN,this.onKeyDown,this),this.app.mouse.on("mousedown",this.mouseClickEvent,this),this.on("destroy",(function(){this.app.mouse.disablePointerLock(),this.app.timeScale=1,this.app.keyboard.off(pc.EVENT_KEYDOWN,this.onKeyDown,this),this.app.mouse.off("mousedown",this.mouseClickEvent,this)})),this.player.script.firstPersonMovement.mouseSensitivity=Config.odczyt().mouse/5,this.player2.script.secondPlayer.mouseSensitivity=Config.odczyt().gamepad/.5;var e=Gra.aktywny().trigger,t=this.save_triggers.filter((t=>t.script.triggerSave.TriggerId===e))[0];if(t){var i=t.script.triggerSave;this.player.rigidbody.teleport(i.FirstPlayerTeleport.getPosition()),this.player2.rigidbody.teleport(i.SecondPlayerTeleport.getPosition()),this.player.script.defaultPos.pos=i.FirstPlayerTeleport.getPosition().clone(),this.player2.script.defaultPos.pos=i.SecondPlayerTeleport.getPosition().clone()}},Pauza.prototype.update=function(e){this._g.update(),this._g.wasPressed(pc.PAD_1,pc.PAD_START)&&this.logic()},Pauza.prototype.mouseClickEvent=function(e){var t=this.app;1==t.timeScale&&t.mouse.enablePointerLock()},Pauza.prototype.onKeyDown=function(e){e.key===pc.KEY_P&&this.logic()},Pauza.prototype.logic=function(){1!=this.app.timeScale?this.unpause():(console.log("PAUSE"),this.menuPauzy.enabled=!0,this.app.mouse.disablePointerLock(),this.app.timeScale=0,this.player.script.enabled=!1,this.player2.script.enabled=!1)},Pauza.prototype.unpause=function(){this.app.timeScale=1,console.log("UNPAUSE"),this.menuPauzy.enabled=!1,this.optionsMenuPauzy.enabled=!1,this.app.mouse.enablePointerLock(),this.player.script.enabled=!0,this.player2.script.enabled=!0,this.player.script.firstPersonMovement.mouseSensitivity=Config.odczyt().mouse/5,this.player2.script.secondPlayer.mouseSensitivity=Config.odczyt().gamepad/.5};var BtnUnpause=pc.createScript("btnUnpause");BtnUnpause.attributes.add("rootEntity",{type:"entity"}),BtnUnpause.prototype.initialize=function(){this.entity.button.on("click",(function(t){this.rootEntity.script.pauza.unpause()}),this)},BtnUnpause.prototype.update=function(t){};var BtnTomenu=pc.createScript("btnTomenu");BtnTomenu.prototype.initialize=function(){this.entity.button.on("click",(function(t){localStorage.removeItem("active_zapis"),this.app.scenes.changeScene("Menu glowne")}),this)},BtnTomenu.prototype.update=function(t){};var HoldingBox=pc.createScript("holdingBox");HoldingBox.attributes.add("howFar",{type:"number",default:3}),HoldingBox.attributes.add("howRight",{type:"number",default:.5}),HoldingBox.attributes.add("forcePower",{type:"number",default:20}),HoldingBox.prototype.initialize=function(){this.gamepads=new pc.GamePads,this.is_grabbed=!1,this.button_is_pressed=!0},HoldingBox.prototype.update=function(t){if(this.gamepads.update(),this.is_grabbed){var e=this.entity.parent.forward.clone().scale(this.howFar).add(this.entity.parent.getPosition()).add(this.entity.parent.right.clone().scale(this.howRight));if(this.entity.getPosition().distance(e)>.01){var i=e.clone();i.sub(this.entity.getPosition()),this.entity.rigidbody.applyForce(i.scale(1e3*this.forcePower))}(this.entity.parent.tags.has("p1")&&this.app.keyboard.wasPressed(pc.KEY_E)||this.entity.parent.tags.has("p2")&&this.gamepads.wasPressed(pc.PAD_1,pc.PAD_FACE_2))&&!this.button_is_pressed?(this.is_grabbed=!1,this.entity.parent.tags.has("p1")?this.entity.parent.parent.script.firstPersonMovement.let_go():this.entity.parent.parent.script.secondPlayer.let_go(),this.entity.reparent(this.app.root),this.entity.rigidbody.linearDamping=0,this.entity.rigidbody.angularFactor=pc.Vec3.ONE):this.entity.parent.tags.has("p1")&&this.app.keyboard.wasPressed(pc.KEY_E)||this.entity.parent.tags.has("p2")&&this.gamepads.wasPressed(pc.PAD_1,pc.PAD_FACE_2)||(this.button_is_pressed=!1)}},HoldingBox.prototype.use=function(t){this.is_grabbed&&(this.entity.parent.tags.has("p1")?this.entity.parent.parent.script.firstPersonMovement.let_go():this.entity.parent.parent.script.secondPlayer.let_go()),this.entity.rigidbody.linearDamping=10,this.entity.rigidbody.angularFactor=pc.Vec3.ZERO,this.entity.reparent(t),this.button_is_pressed=!0,this.entity.rigidbody.angularVelocity=pc.Vec3.ZERO,this.is_grabbed=!0;var e=this.entity.parent.forward.clone().scale(this.howFar).add(this.entity.parent.getPosition()).add(this.entity.parent.right.clone().scale(this.howRight));this.entity.setPosition(e.clone())};var LoadMusicStartScene=pc.createScript("loadMusicStartScene");LoadMusicStartScene.prototype.initialize=function(){this.entity.sound.volume=Config.odczyt().music_volume};var ButtonClick=pc.createScript("buttonClick");ButtonClick.attributes.add("activationEntity",{type:"entity"}),ButtonClick.attributes.add("onButtonMaterial",{type:"asset",assetType:"material"}),ButtonClick.attributes.add("offButtonMaterial",{type:"asset",assetType:"material"}),ButtonClick.prototype.initialize=function(){this.active=!1,this.number=0,this.btn_trigger=this.entity.children.filter((function(t){return"btnTrigger"===t.name}))[0],this.btn_trigger.collision.on("triggerenter",this.onCollisionStart,this),this.btn_trigger.collision.on("triggerleave",this.onCollisionEnd,this)},ButtonClick.prototype.onCollisionStart=function(t){if(this.number++,!this.active){this.activationEntity.enabled=!0,this.active=!0,this.entity.sound.play("Click");var n=this.onButtonMaterial,e=[],o=this.entity.findComponents("render");for(i=0;i<o.length;++i)for(var r=o[i].meshInstances,s=0;s<r.length;s++)e.push(r[s]);for(i=0;i<e.length;++i){e[i].material=n.resource}}},ButtonClick.prototype.onCollisionEnd=function(t){if(this.number--,this.active&&0===this.number){this.active=!1,this.activationEntity.enabled=!1;var n=this.offButtonMaterial,e=[],o=this.entity.findComponents("render");for(i=0;i<o.length;++i)for(var r=o[i].meshInstances,s=0;s<r.length;s++)e.push(r[s]);for(i=0;i<e.length;++i){e[i].material=n.resource}}};var ResetScene=pc.createScript("resetScene");ResetScene.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTriggerEnter,this)},ResetScene.prototype.onTriggerEnter=function(e){var n="Lvl1";null!==pc.app.scenes.find(n)?pc.app.loadSceneHierarchy("Lvl1.json",(function(e,n){e?console.error("Błąd ładowania nowej sceny: "+e):console.log("Nowa scena została załadowana: Lvl1")})):console.error("Scena o nazwie Lvl1 nie istnieje!")};var SecondPlayer=pc.createScript("secondPlayer");SecondPlayer.attributes.add("camera",{type:"entity"}),SecondPlayer.attributes.add("movementSpeed",{type:"number",default:25}),SecondPlayer.attributes.add("runSpeed",{type:"number",default:50}),SecondPlayer.attributes.add("interactionReach",{type:"number",default:4}),SecondPlayer.attributes.add("jumpForce",{type:"number",default:500}),SecondPlayer.attributes.add("mouseSensitivity",{type:"number",default:.25}),SecondPlayer.attributes.add("crosshair",{type:"entity"}),SecondPlayer.prototype.initialize=function(){this.gamepads=new pc.GamePads,this.gamepads.update(),this.force=new pc.Vec3,this.eulers=new pc.Vec3,this.is_holding_smh=!1},SecondPlayer.prototype.update=function(e){this.gamepads.update(),this.handle_movement(e),this.handle_jump(),this.handle_camera_move(),this.handle_interaction()},SecondPlayer.prototype.handle_jump=function(){if(this.gamepads.wasPressed(pc.PAD_1,pc.PAD_FACE_1)){var e=this.entity.getPosition(),t=new pc.Vec3(e.x,e.y-1.1,e.z);this.app.systems.rigidbody.raycastFirst(e,t)&&this.entity.rigidbody.applyImpulse(new pc.Vec3(0,this.jumpForce,0))}},SecondPlayer.prototype.let_go=function(){this.is_holding_smh=!1},SecondPlayer.prototype.handle_interaction=function(){if(!this.is_holding_smh){var e=this.camera.getPosition(),t=this.camera.forward.normalize(),s=(e=e.clone().add(t.scale(.55))).clone().add(t.scale(this.interactionReach-.55)),i=this.app.systems.rigidbody.raycastFirst(e,s);if(i&&i.entity.script){var a=i.entity.script.holdingBox;null!=a?(this.crosshair.element.color.equals(pc.Color.GREEN)||(this.crosshair.element.color=pc.Color.GREEN),this.gamepads.wasPressed(pc.PAD_1,pc.PAD_FACE_2)&&(this.is_holding_smh=!0,a.use(this.camera),this.crosshair.element.color=pc.Color.WHITE)):this.crosshair.element.color.equals(pc.Color.WHITE)||(this.crosshair.element.color=pc.Color.WHITE)}else this.crosshair.element.color.equals(pc.Color.WHITE)||(this.crosshair.element.color=pc.Color.WHITE)}},SecondPlayer.prototype.handle_movement=function(e){var t=this.movementSpeed;this.gamepads.isPressed(pc.PAD_1,pc.PAD_R_SHOULDER_2)&&(t=this.runSpeed),this.entity.rigidbody.linearVelocity=(new pc.Quat).setFromEulerAngles(0,this.eulers.x,0).transformVector(new pc.Vec3(this.gamepads.getAxis(pc.PAD_1,pc.PAD_L_STICK_X)*t*e,this.entity.rigidbody.linearVelocity.y,this.gamepads.getAxis(pc.PAD_1,pc.PAD_L_STICK_Y)*t*e))},SecondPlayer.prototype.handle_camera_move=function(){this.eulers.y-=this.gamepads.getAxis(pc.PAD_1,pc.PAD_R_STICK_Y)*this.mouseSensitivity,this.eulers.x-=this.gamepads.getAxis(pc.PAD_1,pc.PAD_R_STICK_X)*this.mouseSensitivity,this.eulers.y=Math.max(Math.min(this.eulers.y,90),-90),this.camera.setLocalEulerAngles(this.eulers.y,this.eulers.x,0)};var TriggerSave=pc.createScript("triggerSave");TriggerSave.attributes.add("FirstPlayerTeleport",{type:"entity"}),TriggerSave.attributes.add("SecondPlayerTeleport",{type:"entity"}),TriggerSave.attributes.add("TriggerId",{type:"number",default:1}),TriggerSave.attributes.add("BothHaveToTouch",{type:"boolean",default:!0}),TriggerSave.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onCollisionStart,this),this.first_touch=!1,this.second_touch=!1},TriggerSave.prototype.onCollisionStart=function(t){!this.BothHaveToTouch&&t.tags.has("player")?this.save_logic():this.BothHaveToTouch&&t.tags.has("player")&&(!this.first_touch&&t.tags.has("p1")&&(this.first_touch=!0),!this.second_touch&&t.tags.has("p2")&&(this.second_touch=!0),this.first_touch&&this.second_touch&&this.save_logic())},TriggerSave.prototype.save_logic=function(t){var e=Gra.aktywny();this.TriggerId>e.trigger&&(e.trigger=this.TriggerId,e.zapis(),this.app.root.findByTag("p1").filter((t=>"Player 1"===t.name))[0].script.defaultPos.pos=this.FirstPlayerTeleport.getPosition().clone(),this.app.root.findByTag("p2").filter((t=>"Player 2"===t.name))[0].script.defaultPos.pos=this.SecondPlayerTeleport.getPosition().clone())};var PickupAndOpenDoor=pc.createScript("pickupAndOpenDoor");PickupAndOpenDoor.attributes.add("pickupDistance",{type:"number",default:1}),PickupAndOpenDoor.attributes.add("door",{type:"entity"}),PickupAndOpenDoor.prototype.initialize=function(){this.entity.collision.on("collisionstart",this.onCollisionStart,this),this.entity.collision.on("collisionend",this.onCollisionEnd,this)},PickupAndOpenDoor.prototype.onCollisionStart=function(i){var t=i.other;t.tags.has("pickupable")?(this.pickedUpItem=t,i.other.enabled=!1):t===this.door&&this.pickedUpItem&&this.openDoor()},PickupAndOpenDoor.prototype.onCollisionEnd=function(i){i.other===this.pickedUpItem&&(this.pickedUpItem=null)},PickupAndOpenDoor.prototype.openDoor=function(){this.door.enabled=!1},PickupAndOpenDoor.prototype.update=function(i){this.pickedUpItem&&(this.entity.getPosition().distance(this.pickedUpItem.getPosition())<=this.pickupDistance&&(this.pickedUpItem.rigidbody.teleport(this.entity.getPosition()),this.pickedUpItem.rigidbody.linearVelocity=pc.Vec3.ZERO,this.pickedUpItem.rigidbody.angularVelocity=pc.Vec3.ZERO))};var LoadNextLevel=pc.createScript("loadNextLevel");LoadNextLevel.attributes.add("nextLevelName",{type:"string"}),LoadNextLevel.attributes.add("koniecGry",{type:"boolean",default:!1}),LoadNextLevel.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onTriggerEnter,this),this.entity.collision.on("triggerleave",this.onTriggerLeave,this),this.first_p=!1,this.second_p=!1},LoadNextLevel.prototype.onTriggerEnter=function(e){e.tags.has("p1")&&(this.first_p=!0),e.tags.has("p2")&&(this.second_p=!0),this.first_p&&this.second_p&&this.loadNextLevel()},LoadNextLevel.prototype.onTriggerLeave=function(e){e.tags.has("p1")&&(this.first_p=!1),e.tags.has("p2")&&(this.second_p=!1)},LoadNextLevel.prototype.loadNextLevel=function(){if(this.nextLevelName){var e=Gra.aktywny();this.koniecGry?(localStorage.removeItem("game_zapis"+e.id),localStorage.removeItem("active_zapis")):(e.scena=this.nextLevelName,e.trigger=0,e.zapis()),this.app.scenes.changeScene(this.nextLevelName)}else console.error("Nie podano nazwy następnej sceny.")};var SetBackTrigger=pc.createScript("setBackTrigger");SetBackTrigger.prototype.initialize=function(){this.entity.collision.on("triggerenter",this.onCollisionStart,this)},SetBackTrigger.prototype.onCollisionStart=function(i){var t=i.script.defaultPos;t&&(i.rigidbody.linearVelocity=pc.Vec3.ZERO,i.rigidbody.teleport(t.get()),i.rigidbody.linearVelocity=pc.Vec3.ZERO)};